<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF=8'>
</head>

<body style='width: 100%; margin: auto;'>
    <p style='text-align: center; font-size: 2em; font-weight: 1000; margin-bottom: 0.5em;'>유지보수 점검 확인서</p>
    <div style='overflow: auto;'>
        <span style='float: left;'>SITE : ${customer}</span>
        <span style='float: right;''>엔지니어 : ${engineer} (인)</span>
    </div>
    <div style=' overflow: auto;'>
            <span style='float: left'>DATE : ${yyyy_mm_dd_today}</span>
            <span style='float: right;'>담당자 : ${manager} (인)</span>
    </div>
    <div>
        <div class='container' style='margin-top: 10px;'>
            <div class='title' style='margin-top: 10px; flex: 1;'>
                <div style='border-bottom: solid 0.1em black;'>Service</div>
                <div style='border-bottom: solid 0.1em black;'>Hostname</div>
                <div style='border-bottom: solid 0.1em black;'>OS ver.</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>DBMS ver.</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>CPU</div>
                <div style='padding-left: 5px;'>Memory</div>
            </div>
            <div style='margin-top: 10px; flex: 1; border-top: solid 0.1em; border-bottom: solid 0.1em;'>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${customer}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${hostname}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${os_ver}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${version}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${cpu_model}</div>
                <div style='padding-left: 5px;'>${mem_total}</div>
            </div>
            <div class='title' style='margin-top: 10px; flex: 1'>
                <div style='border-bottom: solid 0.1em black;'>Port</div>
                <div style='border-bottom: solid 0.1em black;'>Basedir</div>
                <div style='border-bottom: solid 0.1em black;'>Datadir</div>
                <div style='border-bottom: solid 0.1em black;'>Binary Log</div>
                <div style='border-bottom: solid 0.1em black;'>Error Log</div>
                <div>Slow query Log</div>
            </div>
            <div
                style='margin-top: 10px; flex: 1; border-top: solid 0.1em; border-bottom: solid 0.1em; border-right: solid 0.1em;'>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${port}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${basedir}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${datadir}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${binary_log}</div>
                <div style='border-bottom: solid 0.1em black; padding-left: 5px;'>${error_log}</div>
                <div style='padding-left: 5px;'>${slow_query_log}</div>
            </div>
        </div>

        <div style='border: solid 0.1em black;'>
            <div class='container' style='margin-top: 10px;'>
                <span class='title'>항목</span>
                <span class='title'>세부 항목</span>
                <span class='title'>기준값</span>
                <span class='title'>점검결과값</span>
                <span class='title'>점검결과</span>
            </div>
            <div class='container' style='margin-top: 0px;'>
                <span class='content'>OS</span>
                <span class='content'>Disk Usage</span>
                <span class='content'>80% 이하</span>
                <span class='content'>${disk_usage}</span>
                <span class='content' id='result'>$(check_recommended_value ${disk_usage} 80 down)</span>
            </div>
            <div class='container' style='margin-top: 0px;'>
                <span class='content'>Data & Index Size</span>
                <span class='content'>데이터와 인덱스 크기</span>
                <span class='content'>N/A</span>
                <span class='content'>${data_index_size}</span>
                <span class='content' id='result'>양호</span>
            </div>
            <div class='container' id='graph' style='margin-top: 0px;'>
                <canvas id='myChart' style='width: 350; height:250px'></canvas>
                <script src='Chart.min.js'></script>
                <script src='https://cdn.jsdelivr.net/npm/chart.js'></script>
                <script>
                    const ctx = document.getElementById('myChart');

                    var myChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: [${ graph_months }],
                        datasets: [{
                            label: '# Data & Index size (${graph_unit})',
                            data: [${ graph_data }],
                            borderWidth: 1
                        }]
                        },
                    options: {
                        responsive: false,
                            maintainAspectRatio: true,
                                scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                    });
                </script>
            </div>
            <div class='container' style='margin-top: 0px; border-top: solid 0.1em black;'>
                <span class='content'>Ibdata Size</span>
                <span class='content'>System Tablespace 크기</span>
                <span class='content'>N/A</span>
                <span class='content'>${innodb_data_file_size}</span>
                <span class='content' id='result'>양호</span>
            </div>
            <div class='container' style='margin-top: 0px;'>
                <span class='content'>Memory Usage</span>
                <span class='content'>메모리 사용률</span>
                <span class='content'>80% 이하</span>
                <span class='content'>${memory_usage}</span>
                <span class='content' id='result'>$(check_recommended_value ${memory_usage} 80 down)</span>
            </div>

            <div class='container'>
                <div class='content' ;>
                    <div>　</div>
                    <div>Hit rate</div>
                    <div>　</div>
                </div>
                <div class='content'>
                    <div>InnoDB Buffer Pool hit rate</div>
                    <div>Key Buffer hit rate</div>
                    <div>Thread Cache miss rate</div>
                </div>
                <div class='content'>
                    <div>
                        <div>${innodb_buffer_pool_hit_rate}</div>
                        <div>${key_buffer_hit_rate}</div>
                        <div>${thread_cache_miss_rate}</div>
                    </div>
                </div>
                <div class='content'>
                    <div>
                        <div>99.95%</div>
                        <div>-%</div>
                        <div>12.16%</div>
                    </div>
                </div>
                <div class='content'>
                    <div id='result'>$(check_recommended_value ${innodb_buffer_pool_hit_rate} 90 up)</div>
                    <div id='result'>$(check_recommended_value ${key_buffer_hit_rate} 90 up)</div>
                    <div id='result'>$(check_recommended_value ${thread_cache_miss_rate} 10 down)</div>
                </div>
            </div>

            <div class='container' style='margin-top: 0px;'>
                <span class='content'>Max Connetion</span>
                <span class='content'>최대 접속된 세션 수</span>
                <span class='content'>80% 이하</span>
                <span class='content'>${max_used_connect}</span>
                <span class='content' id='result'>$(check_recommended_value ${max_used_connect} 80 down)</span>
            </div>
            <div class='container' style='margin-top: 0px;'>
                <span class='content'>Connection Miss Rate</span>
                <span class='content'>Connection Miss Rate</span>
                <span class='content'>10% 이하</span>
                <span class='content'>${aborted_connects}</span>
                <span class='content' id='result'>$(check_recommended_value ${aborted_connects} 1 down)</span>
            </div>
            <div class='container' style='margin-top: 0px;'>
                <span class='content'>Created Tmp</span>
                <span class='content'>Created tmp disk tables</span>
                <span class='content'>10% 미만</span>
                <span class='content'>${tmp_disk_rate}</span>
                <span class='content' id='result'>$(check_recommended_value ${tmp_disk_rate} 10 down)</span>
            </div>
            <div class='container'>
                <div class='content'>
                    <div>　</div>
                    <div>　</div>
                    <div>Status</div>
                    <div>　</div>
                    <div>　</div>
                    <div>　</div>
                </div>
                <div class='content'>
                    <div>Uptime</div>
                    <div>History list length</div>
                    <div>QPS</div>
                    <div>TPS</div>
                    <div>InnoDB engine status</div>
                    <div>Replication slave status</div>
                </div>
                <div class='content'>
                    <div>
                        <div>N/A</div>
                        <div>N/A</div>
                        <div>N/A</div>
                        <div>N/A</div>
                        <div>N/A</div>
                        <div>N/A</div>
                    </div>
                </div>
                <div class='content'>
                    <div>
                        <div>${converted_uptime}</div>
                        <div>${rollback_segment}</div>
                        <div>${qps}</div>
                        <div>${tps}</div>
                        <div>${innodb_status_message}</div>
                        <div>${server_type}</div>
                    </div>
                </div>
                <div class='content'>
                    <div id='result'>양호</div>
                    <div id='result'>양호</div>
                    <div id='result'>주의</div>
                    <div id='result'>양호</div>
                    <div id='result'>$(check_recommended_value_2 ${innodb_status_message})</div>
                    <div id='result'>$(check_recommended_value_2 ${server_type})</div>
                </div>
            </div>
            <div class='container'>
                <div class='content'>
                    <div>DBMS Log</div>
                    <div>　</div>
                </div>
                <div class='content'>
                    <div>Binary Log</div>
                    <div>Relay Log</div>
                </div>
                <div class='content'>
                    <div>
                        <div>N/A</div>
                        <div>N/A</div>
                    </div>
                </div>
                <div class='content'>
                    <div>
                        <div>${binary_log_file_size}</div>
                        <div>${relay_log_file_size}</div>
                    </div>
                </div>
                <div class='content'>
                    <div id='result'>양호</div>
                    <div id='result'>양호</div>
                </div>
            </div>
            <div class='container'>
                <div class='content'>
                    <div>　</div>
                    <div>Full Join</div>
                    <div>　</div>
                </div>
                <div class='content'>
                    <div>select_full_join</div>
                    <div>select_scan</div>
                    <div>sort_merge_passes</div>
                </div>
                <div class='content'>
                    <div>
                        <div>N/A</div>
                        <div>N/A</div>
                        <div>N/A</div>
                    </div>
                </div>
                <div class='content'>
                    <div>
                        <div>${select_full_join}</div>
                        <div>${select_scan}</div>
                        <div>${sort_merge_passes}</div>
                    </div>
                </div>
                <div class='content'>
                    <div id='result'>양호</div>
                    <div id='result'>양호</div>
                    <div id='result'>양호</div>
                </div>
            </div>
            <div style='background-color: #DAEEF3; text-align: center; border: solid 0.1em black;'>특이사항</div>
            <div style='height: 80px; border: solid 0.1em black'>특이사항 없습니다.</div>
            <div style='background-color: #DAEEF3; text-align: center; border: solid 0.1em black;'>점검결과</div>
            <div style='height: 60px; border: solid 0.1em black'>점검결과 양호합니다.</div>
        </div>
    </div>
        <footer>
            <p>&copy; 2023. (Rockplace) All rights reserved.</p>
        </footer>
</body>

</html>

<style>
    body {
        font-size: 12px;
    }

    .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .title {
        flex: 1;
        font-weight: 700;
        text-align: center;
        background-color: #DAEEF3;
        border: solid 0.1em black;
    }

    .content {
        flex: 1;
        font-weight: 350;
        text-align: center;
        border: solid 0.1em black;
    }

    .content_div {
        flex: 1;
        font-weight: 350;
        text-align: center;
    }

    footer {
        text-align: right;
    }


    .warning {
        color: red;
    }

    .good {
        color: green;
    }

    #graph {
        margin-left: 150px;
    }

    @media print {
        body {
            -webkit-print-color-adjust: exact;
            width: 210mm;
            height: 297mm;
            margin: 0;
            padding: 0;
        }
    }
</style>

<script>
    window.onload = function () {
        const boxes = document.querySelectorAll('#result');

        boxes.forEach(box => {
            const content = box.textContent.trim();

            if (content === '주의') {
                box.classList.add('warning');
            } else if (content === '양호') {
                box.classList.add('good');
            }
        });
    };
</script>