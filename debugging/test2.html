<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Document</title>
</head>

<body>
    <div style='width: 70%; margin: auto; padding-top: 3em; border: solid 0.1em black'>
        <p style='font-size: 1.7em; display: flex; justify-content: center; font-weight: 1000; margin: 0 auto;  '>유지보수
            점검 확인서</p>
        <div
            style='width: 20em ; display: flex; border-bottom: 0.2em double black; margin: 0 auto; margin-bottom: 1em; padding-top:0.2em;'>
        </div>
        <div style='display: flex; justify-content: space-between;'>
            <span id='top_left' style='margin-bottom: 1em'>▣ SITE : ${customer}</span>
            <span id='top_right'>▣ 엔지니어 : ${engineer} (인)</span>
        </div>
        <div style='display: flex; justify-content: space-between; margin-bottom: -0.3em;'>
            <span id='top_left'>▣ DATE : 2023-05-28</span>
            <span id='top_right'>▣ 담당자 : ${manager} (인)</span>
        </div>
        <div id='sub_title'>
            <div>Service</div>
            <div>Hostname</div>
            <div>OS ver.</div>
            <div>MySQL ver.</div>
        </div>
        <div class='info-row'>
            <span>${customer}</span>
            <span>${hostname}</span>
            <span>${os_ver}</span>
            <span>${version}</span>
        </div>
        <div id='sub_title'>
            <div>CPU</div>
            <div>Memory</div>
            <div>Port</div>
        </div>
        <div class='info-row'>
            <span>${cpu_model}</span>
            <span>${mem_total}</span>
            <span>${port}</span>
        </div>
        <div id='sub_title'>
            <div>Basedir</div>
            <div>Datadir</div>
            <div>Binary Log</div>
        </div>
        <div class='info-row'>
            <span>${basedir}</span>
            <span>${datadir}</span>
            <span>${binary_log}</span>
        </div>
        <div id='sub_title'>
            <div>Error Log</div>
            <div>Slow Query Log</div>
        </div>
        <div class='info-row'>
            <span>${error_log}</span>
            <span>${slow_query_log}</span>
        </div>
        <hr>
        <p
            style='font-size: 1.3em; display: flex; justify-content: center; font-weight: 1000; margin: 0 auto; margin-bottom: 0.5em;  '>
            점검 세부
            항목</p>
        <div style=''>
            <div id='detail_title'>
                <div>항목</div>
                <div>세부 항목</div>
                <div>기준값</div>
                <div>점검결과값</div>
                <div>점검결과</div>
            </div>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>OS</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='box'>Disk usage</div>
                    <div class='box'>Auto Start Check</div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>80% 이하</div>
                        <div class='box'>권고하지 않음</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='box'>${disk_usage}</div>
                    <div class='box'>-</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>$(check_recommended_value ${disk_usage} 80 down)</div>
                    <div class='box'>양호</div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Data & Index Size</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>사용중인 데이터와 인덱스 크기</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>N/A</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>${data_index_size}</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>양호</div>
                    </div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <canvas id='myChart'></canvas>
                    <!-- <script src='Chart.min.js'></script> -->
                    <script src='https://cdn.jsdelivr.net/npm/chart.js'></script>
                    <script>
                        const ctx = document.getElementById('myChart');

                        const dataUrl = 'data.json';

                        function fetchData() {
                            return fetch(dataUrl)
                                .then(response => response.json())
                                .catch(error => console.error('Error fetching data: ', error));

                            return data;
                        }


                        function drawChart(data) {
                            const myChart = new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: data.labels,
                                    datasets: [{
                                        label: '# Data & Index size (GB)',
                                        data: data.data,
                                        borderWidth: 1
                                    }]
                                },
                                options: {
                                    scales: {
                                        y: {
                                            beginAtZero: true
                                        }
                                    }
                                }
                            });
                        }
                        fetchData()
                            .then(data => drawChart(data))
                            .catch(error => console.error('에러 발생: ', error));


                    </script>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='box'>ibdata size</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>System Tablespace 증가 여부 확인</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>N/A</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>${innodb_data_file_size}</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>양호</div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='box'>MySQL Memory Usage</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>현재 MySQL 메모리 사용률</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>80% 이하</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>${memory_usage}</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>$(check_recommended_value ${memory_usage} 80 down)</div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Hit rate</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='box'>InnoDB Buffer Pool hit rate</div>
                    <div class='box'>Key Buffer hit rate</div>
                    <div class='box'>Thread Cache miss rate</div>
                    <div class='box'>Index Usage</div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>100%</div>
                        <div class='box'>100%</div>
                        <div class='box'>0%</div>
                        <div class='box'>100%</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>${innodb_buffer_pool_hit_rate}</div>
                        <div class='box'>${key_buffer_hit_rate}</div>
                        <div class='box'>${thread_cache_miss_rate}</div>
                        <div class='box'>${index_usage}</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='box'>$(check_recommended_value ${innodb_buffer_pool_hit_rate} 99 up)</div>
                    <div class='box'>양호</div>
                    <div class='box'>$(check_recommended_value ${thread_cache_miss_rate} 0 down)</div>
                    <div class='box'>$(check_recommended_value ${index_usage} 99 up)</div>
                </div>
            </div>
            <hr>
            </gr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='box'>Max Connection</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>최대 접속된 클라이언트 수</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>80% 이하</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>${max_used_connect}</div>
                </div>
                <div class='flex-item'>
                    <div class='box'>$(check_recommended_value ${max_used_connect} 80 down)</div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Connection Miss Rate</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Aborted connections</div>
                        <div class='box'>Connections</div>
                        <div class='box'>Connections miss rate</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>1% 미만</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>${aborted_connects}</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>$(check_recommended_value ${aborted_connects} 1 down)</div>
                    </div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Created Tmp</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Created tmp disk tables</div>
                        <div class='box'>Created tmp tables</div>
                        <div class='box'>Created tmp files</div>
                        <div class='box'>Created disk tmp rate</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>1% 미만</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>${tmp_disk_rate}</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>$(check_recommended_value ${tmp_disk_rate} 1 down)</div>
                    </div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Status</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Uptime</div>
                        <div class='box'>History list length</div>
                        <div class='box'>QPS</div>
                        <div class='box'>TPS</div>
                        <div class='box'>InnoDB engine status</div>
                        <div class='box'>Replication Slave status</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>${converted_uptime}</div>
                        <div class='box'>${rollback_segment}</div>
                        <div class='box'>${qps}</div>
                        <div class='box'>${tps}</div>
                        <div class='box'>${innodb_status_message}</div>
                        <div class='box'>${server_type}</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                        <div class='box'>$(check_recommended_value_2 ${innodb_status_message})</div>
                        <div class='box'>$(check_recommended_value_2 ${server_type})</div>
                    </div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>MySQL Log</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Error Log</div>
                        <div class='box'>Slow Query Log</div>
                        <div class='box'>Binary Log</div>
                        <div class='box'>Relay Log</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>수정필요</div>
                        <div class='box'>수정필요</div>
                        <div class='box'>${binary_log_file_size}</div>
                        <div class='box'>${relay_log_file_size}</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                    </div>
                </div>
            </div>
            <hr>
            <div class='flex-container'>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>Full Join</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>select full join</div>
                        <div class='box'>select_scan</div>
                        <div class='box'>sort_merge_passes</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                        <div class='box'>N/A</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>${select_full_join}</div>
                        <div class='box'>${select_scan}</div>
                        <div class='box'>${sort_merge_passes}</div>
                    </div>
                </div>
                <div class='flex-item'>
                    <div class='merged-column'>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                        <div class='box'>양호</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>


<style>
    .info-row {
        margin-top: 0.2em;
        display: flex;
        justify-content: space-between;
    }

    .info-row span {
        flex: 1;
        text-align: center;
    }

    #sub_title {
        margin-top: 0.5em;
        display: flex;
        justify-content: space-between;
        background-color: bisque;
        padding: 0.2em;
        display: flex;
        justify-content: space-between;
    }

    #sub_title div {
        flex: 1;
        text-align: center;
    }

    #detail_title {
        /* margin-top: 0.5em; */
        display: flex;
        justify-content: space-between;
        background-color: bisque;
        padding: 0.2em;
        display: flex;
        justify-content: space-between;
    }

    #detail_title div {
        flex: 1;
        text-align: center;
    }

    #top_left {
        padding-left: 5em;
        text-align: left;
    }

    #top_right {
        padding-right: 5em;
        text-align: right;
    }

    .flex-container {
        display: flex;
    }

    .box {
        flex: 1;
        height: 100px;
    }

    .flex-item {
        display: flex;
        flex: 1;
        flex-direction: column;
    }

    .flex-item div {
        text-align: center;
    }

    .flex-container {
        display: flex;
    }

    .flex-item {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .merged-column {
        display: flex;
        flex-direction: column;
    }

    .box {
        height: 1em;
        padding: 0.5em;
        /* 다른 스타일링 속성 추가 */
    }

    .warning {
        color: red;
    }

    .good {
        color: green;
    }
</style>

<script>
    window.onload = function () {
        const boxes = document.querySelectorAll('.box');

        boxes.forEach(box => {
            const content = box.textContent.trim();

            if (content === '주의') {
                box.classList.add('warning');
            } else if (content === '양호') {
                box.classList.add('good');
            }
        });
    };
</script>